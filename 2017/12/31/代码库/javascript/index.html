<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><title>javascript - Awoke</title><meta name="description" content="javascript.原文：https://github.com/2json/snippetsThe common snippets of the javascript :blush:防反跳 / debounce123456789const debounce = (action, delay) =&amp;"><link type="text/css" rel="stylesheet" href="/css/pure.css?v=0.0.1"><link type="text/css" rel="stylesheet" href="/css/style.css?v=0.0.1"><script type="text/javascript" src="//cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script></head></html><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">javascript</h1><a id="logo" href="/.">Awoke</a></div><div id="nav-menu"><div class="bitcron_nav"><div class="site_nav_wrap"><div class="site_nav"><span class="a_container"><a href="/." class="selected active current">归档</a></span><span class="a_container"><a href="/about/">关于</a></span></div></div></div></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">javascript</h1><div class="post-meta">2017-12-31</div><!--文章内容--><div class="post-content"><p>javascript.</p>
<a id="more"></a>
<p>原文：<a href="https://github.com/2json/snippets" target="_blank" rel="noopener">https://github.com/2json/snippets</a></p>
<h1 id="The-common-snippets-of-the-javascript-blush"><a href="#The-common-snippets-of-the-javascript-blush" class="headerlink" title="The common snippets of the javascript :blush:"></a>The common snippets of the javascript :blush:</h1><h4 id="防反跳-debounce"><a href="#防反跳-debounce" class="headerlink" title="防反跳 / debounce"></a>防反跳 / debounce</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> debounce = <span class="function">(<span class="params">action, delay</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> timer</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> context = <span class="keyword">this</span></span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">arguments</span></span><br><span class="line">    clearTimeout(timer)</span><br><span class="line">    timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123; action.apply(context, args) &#125;, delay)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="拉平数组-flatten"><a href="#拉平数组-flatten" class="headerlink" title="拉平数组 / flatten"></a>拉平数组 / flatten</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flatten = <span class="function"><span class="params">arr</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> list = []</span><br><span class="line">    <span class="keyword">const</span> flattenFunc = <span class="function"><span class="params">arg</span> =&gt;</span> arg.forEach(<span class="function"><span class="params">item</span> =&gt;</span> <span class="built_in">Array</span>.isArray(item) ? flattenFunc(item) : list.push(item))</span><br><span class="line">    flattenFunc(arr)</span><br><span class="line">    <span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取函数的返回值-value"><a href="#获取函数的返回值-value" class="headerlink" title="获取函数的返回值 / value"></a>获取函数的返回值 / value</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> value = <span class="function"><span class="params">func</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> valueFunc = <span class="function"><span class="params">arg</span> =&gt;</span> <span class="keyword">typeof</span> arg === <span class="string">'function'</span> ? valueFunc(arg()) : arg</span><br><span class="line">  <span class="keyword">return</span> valueFunc(func)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="动态加载javascript"><a href="#动态加载javascript" class="headerlink" title="动态加载javascript"></a>动态加载javascript</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadScript</span>(<span class="params">url, callback</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">  script.type = <span class="string">'text/javascript'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(script.readyState)&#123; <span class="comment">//IE</span></span><br><span class="line">    script.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(script.readyState === <span class="string">'loaded'</span> || script.readyState === <span class="string">'complete'</span>)&#123;</span><br><span class="line">        script.onreadystatechange = <span class="literal">null</span>;</span><br><span class="line">        callback()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123; <span class="comment">//Others</span></span><br><span class="line">    script.onload = callback.call(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  script.url = url;</span><br><span class="line">  <span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>].appendChild(script);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>From:<a href="https://www.nczonline.net/blog/2009/07/28/the-best-way-to-load-external-javascript/" target="_blank" rel="noopener">The best way to load external JavaScript</a></p>
</blockquote>
<h4 id="移动端页面初始化"><a href="#移动端页面初始化" class="headerlink" title="移动端页面初始化"></a>移动端页面初始化</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">;(<span class="function"><span class="keyword">function</span>(<span class="params">factory</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">window</span>.factory = factory(<span class="built_in">window</span>, <span class="built_in">document</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">window</span>.factory;</span><br><span class="line">&#125;)(<span class="function"><span class="keyword">function</span>(<span class="params">win, doc</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> context = &#123;</span><br><span class="line">    init:<span class="function"><span class="keyword">function</span>(<span class="params">scale</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> html = <span class="built_in">document</span>.documentElement;</span><br><span class="line">      <span class="keyword">var</span> width = html.clientWidth &gt; scale ? scale : html.clientWidth;</span><br><span class="line">      <span class="keyword">var</span> dpr = <span class="built_in">window</span>.devicePixelRatio &gt;= <span class="number">1.5</span> ? <span class="number">2</span> : <span class="built_in">window</span>.devicePixelRatio;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//设置html的dpr和fontsize</span></span><br><span class="line">      html.setAttribute(<span class="string">'data-dpr'</span>, dpr);</span><br><span class="line">      html.style.fontSize = width * <span class="number">100</span> / scale + <span class="string">'px'</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//设置body的宽度--可以解决微信内置浏览器里面的一个小bug</span></span><br><span class="line">      <span class="keyword">this</span>.setBody();</span><br><span class="line">    &#125;,</span><br><span class="line">    view:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        w:<span class="built_in">document</span>.documentElement.clientWidth,</span><br><span class="line">        h:<span class="built_in">document</span>.documentElement.clientHeight</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    setBody:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> body = <span class="built_in">document</span>.body;</span><br><span class="line">      body.style.width = <span class="keyword">this</span>.view().w + <span class="string">'px'</span>;</span><br><span class="line">      body.style.height = <span class="keyword">this</span>.view().h + <span class="string">'px'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="获取随机数"><a href="#获取随机数" class="headerlink" title="获取随机数"></a>获取随机数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params">min, max</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//左开右闭</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.ceil(<span class="built_in">Math</span>.random() * (max - min + <span class="number">1</span>) + min);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params">min, max</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//左闭右开</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (max - min + <span class="number">1</span>) + min);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params">min, max</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//闭区间</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.round(<span class="built_in">Math</span>.random() * (max - min + <span class="number">1</span>) + min, <span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取元素的计算之后的样式"><a href="#获取元素的计算之后的样式" class="headerlink" title="获取元素的计算之后的样式"></a>获取元素的计算之后的样式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getStyle</span>(<span class="params">obj, attr</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> obj.currentStyle ? obj.currentStyle[attr] : getComputedStyle(obj, <span class="literal">null</span>)[attr];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="判断对象的数据类型"><a href="#判断对象的数据类型" class="headerlink" title="判断对象的数据类型"></a>判断对象的数据类型</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">type</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(obj).match(<span class="regexp">/\s(\w+)/</span>)[<span class="number">1</span>].toLowerCase();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="对象复制"><a href="#对象复制" class="headerlink" title="对象复制"></a>对象复制</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">obj, deep</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">if</span>(type(obj) !== <span class="string">'object'</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="comment">//利用JSON的方法进行深复制和浅复制</span></span><br><span class="line">  <span class="keyword">return</span> result = deep ? <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj)) : obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="判断网页是否在微信浏览器打开"><a href="#判断网页是否在微信浏览器打开" class="headerlink" title="判断网页是否在微信浏览器打开"></a>判断网页是否在微信浏览器打开</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isWeChat</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> navigator.userAgent.toLowerCase().match(<span class="regexp">/MicroMessenger/i</span>) === <span class="string">"micromessenger"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="判断手机系统"><a href="#判断手机系统" class="headerlink" title="判断手机系统"></a>判断手机系统</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isApple</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="regexp">/ip(hone|ad|od)/i</span>.test(navigator.userAgent.toLowerCase());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isAndroid</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="regexp">/android/i</span>.test(navigator.userAgent.toLowerCase());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取查询字符串的值"><a href="#获取查询字符串的值" class="headerlink" title="获取查询字符串的值"></a>获取查询字符串的值</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getQuery</span>(<span class="params">url</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">var</span> query = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  url = url &amp;&amp; url.charAt(<span class="number">0</span>) === <span class="string">'?'</span> ? url.slice(<span class="number">1</span>) : url || location.search.slice(<span class="number">1</span>);</span><br><span class="line">  arr = url.split(<span class="string">'&amp;'</span>);</span><br><span class="line"></span><br><span class="line">  arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = v.split(<span class="string">'='</span>);</span><br><span class="line">    query[a[<span class="number">0</span>]] = <span class="built_in">encodeURIComponent</span>(a[<span class="number">1</span>]);</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> query;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取元素在页面中的位置"><a href="#获取元素在页面中的位置" class="headerlink" title="获取元素在页面中的位置"></a>获取元素在页面中的位置</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPosition</span>(<span class="params">ele</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> position = &#123;</span><br><span class="line">    left:ele.offsetLeft,</span><br><span class="line">    top:ele.offsetTop</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">var</span> currentParent = ele.offsetParent;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (currentParent !== <span class="literal">null</span>) &#123;</span><br><span class="line">    position.left += currentParent.offsetLeft;</span><br><span class="line">    position.top += currentParent.offsetTop;</span><br><span class="line">    currentParent = currentParent.offsetParent;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPosition</span>(<span class="params">ele</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ele.getBoundingClientRect();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="js仿照md5"><a href="#js仿照md5" class="headerlink" title="js仿照md5"></a>js仿照md5</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> str = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span>;</span><br><span class="line">  <span class="keyword">return</span> str.split(<span class="string">''</span>).sort(<span class="function"><span class="keyword">function</span>(<span class="params">v1,v2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.random() &gt; <span class="number">0.5</span>;</span><br><span class="line">  &#125;).join(<span class="string">''</span>).slice(<span class="number">0</span>, <span class="number">32</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取星期几"><a href="#获取星期几" class="headerlink" title="获取星期几"></a>获取星期几</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDay</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [<span class="string">'星期天'</span>, <span class="string">'星期一'</span>, <span class="string">'星期二'</span>, <span class="string">'星期三'</span>, <span class="string">'星期四'</span>, <span class="string">'星期五'</span>, <span class="string">'星期六'</span>];</span><br><span class="line">  <span class="keyword">return</span> arr[<span class="keyword">new</span> <span class="built_in">Date</span>().getDay()];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="requestAnimationFrame的兼容性处理"><a href="#requestAnimationFrame的兼容性处理" class="headerlink" title="requestAnimationFrame的兼容性处理"></a>requestAnimationFrame的兼容性处理</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> lastTime = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">var</span> vendors = [<span class="string">'ms'</span>, <span class="string">'moz'</span>, <span class="string">'webkit'</span>, <span class="string">'o'</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; vendors.length &amp;&amp; !<span class="built_in">window</span>.requestAnimationFrame; ++i)&#123;</span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame = <span class="built_in">window</span>[vendors[i] + <span class="string">'RequestAnimationFrame'</span>];</span><br><span class="line">    <span class="built_in">window</span>.cancelAnimationFrame = <span class="built_in">window</span>[vendors[i] + <span class="string">'CancelAnimationFrame'</span>] ||  <span class="built_in">window</span>[vendors[x] + <span class="string">'CancelRequestAnimationFrame'</span>];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">window</span>.requestAnimationFrame) <span class="built_in">window</span>.requestAnimationFrame = <span class="function"><span class="keyword">function</span>(<span class="params">callback, element</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> currTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">      <span class="keyword">var</span> timeToCall = <span class="built_in">Math</span>.max(<span class="number">0</span>, <span class="number">16</span> - (currTime - lastTime));</span><br><span class="line">      <span class="keyword">var</span> id = <span class="built_in">window</span>.setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">          callback(currTime + timeToCall);</span><br><span class="line">      &#125;, timeToCall);</span><br><span class="line">      lastTime = currTime + timeToCall;</span><br><span class="line">      <span class="keyword">return</span> id;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">window</span>.cancelAnimationFrame) <span class="built_in">window</span>.cancelAnimationFrame = <span class="function"><span class="keyword">function</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">      clearTimeout(id);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<h4 id="数组去重"><a href="#数组去重" class="headerlink" title="数组去重"></a>数组去重</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(<span class="keyword">this</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sortArr = <span class="keyword">this</span>.sort();</span><br><span class="line">  <span class="keyword">return</span> sortArr.filter(<span class="function"><span class="keyword">function</span>(<span class="params">v,i,context</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> v != context[i+<span class="number">1</span>];</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = [];</span><br><span class="line">  <span class="keyword">this</span>.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(result.indexOf(v) === <span class="number">-1</span>)&#123;</span><br><span class="line">      result.push(v);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> json = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> result = [];</span><br><span class="line">  <span class="keyword">this</span>.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> type = <span class="built_in">Object</span>.prototype.toString.call(value).match(<span class="regexp">/\s(\w+)/</span>)[<span class="number">1</span>].toLowerCase();</span><br><span class="line">    <span class="keyword">if</span>(!((type + <span class="string">'-'</span>+value) <span class="keyword">in</span> json))&#123;</span><br><span class="line">      json[type + <span class="string">'-'</span>+value] = <span class="literal">true</span>;</span><br><span class="line">      result.push(value);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sortArr = <span class="keyword">this</span>.sort(),</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(; i &lt; sortArr.length; i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(sortArr[i] === sortArr[i+<span class="number">1</span>])&#123;</span><br><span class="line">      sortArr.splice(i,<span class="number">1</span>);</span><br><span class="line">      i--;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sortArr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sortArr = <span class="keyword">this</span>.sort(), result = [];</span><br><span class="line">  sortArr.reduce(<span class="function">(<span class="params">v1,v2</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(v1 !== v2)&#123;</span><br><span class="line">      result.push(v1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> v2;</span><br><span class="line">  &#125;)</span><br><span class="line">  result.push(sortArr[sortArr.length - <span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="操作className"><a href="#操作className" class="headerlink" title="操作className"></a>操作className</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//操作className时候的辅助函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toArray</span>(<span class="params">argu</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> splitText = <span class="keyword">typeof</span> argu === <span class="string">'string'</span> ? (argu.indexOf(<span class="string">' '</span>) !== <span class="number">-1</span> ? <span class="string">' '</span> : <span class="string">','</span>) : <span class="string">' '</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.isArray(argu) ? argu : argu.split(splitText);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>说明：以下四种方法的参数的形式可以为以下几种</p>
</blockquote>
<blockquote>
<ul>
<li>数组：[‘classname1’, ‘classname2’]</li>
<li>string<ul>
<li>单字符串:’classname1’</li>
<li>空格分隔: ‘classname1 classname2’</li>
<li>逗号分隔: ‘classname1, classname2’</li>
</ul>
</li>
</ul>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">HTMLElement.prototype.hasClass = <span class="function"><span class="keyword">function</span> (<span class="params">classname</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> selfClass = <span class="keyword">this</span>.className.split(<span class="string">' '</span>);</span><br><span class="line">      classname = toArray(classname);</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.classList)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> v <span class="keyword">of</span> classname)&#123;</span><br><span class="line">      <span class="keyword">if</span>(!<span class="keyword">this</span>.classList.contains(v))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> v <span class="keyword">of</span> classname)&#123;</span><br><span class="line">      <span class="keyword">if</span>(selfClass.indexOf(v) === <span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HTMLElement.prototype.addClass = <span class="function"><span class="keyword">function</span> (<span class="params">classname</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.className = <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>((toArray(classname).join(<span class="string">' '</span>) + <span class="string">' '</span> + <span class="keyword">this</span>.className).split(<span class="string">' '</span>))).join(<span class="string">' '</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HTMLElement.prototype.addClass = <span class="function"><span class="keyword">function</span> (<span class="params">classname</span>) </span>&#123;</span><br><span class="line">  classname = toArray(classname);</span><br><span class="line">  classname.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">this</span>.hasClass(v))&#123;</span><br><span class="line">      <span class="keyword">this</span>.className += <span class="string">' '</span> + v;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;.bind(<span class="keyword">this</span>))</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HTMLElement.prototype.removeClass = <span class="function"><span class="keyword">function</span> (<span class="params">classname</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> selfClass = <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(<span class="keyword">this</span>.className.split(<span class="string">' '</span>)));</span><br><span class="line">      classname = toArray(classname);</span><br><span class="line">  classname.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(selfClass.indexOf(v) !== <span class="number">-1</span>)&#123;</span><br><span class="line">      selfClass.splice(selfClass.indexOf(v), <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">this</span>.className = selfClass.join(<span class="string">' '</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HTMLElement.prototype.toggleClass = <span class="function"><span class="keyword">function</span> (<span class="params">classname</span>) </span>&#123;</span><br><span class="line">  classname = toArray(classname);</span><br><span class="line">  classname.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.hasClass(v))&#123;</span><br><span class="line">      <span class="keyword">this</span>.removeClass(v)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.addClass(v);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;.bind(<span class="keyword">this</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="判断网页运行在电脑还是手机"><a href="#判断网页运行在电脑还是手机" class="headerlink" title="判断网页运行在电脑还是手机"></a>判断网页运行在电脑还是手机</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回true是手机，否则是电脑</span></span><br><span class="line"><span class="keyword">const</span> isMobile = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="string">'android'</span>, <span class="string">'iphone'</span>, <span class="string">'symbianos'</span>, <span class="string">'windows phone'</span>, <span class="string">'ipad'</span>, <span class="string">'ipod'</span>].some(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> navigator.userAgent.toLowerCase().indexOf(v) &gt;= <span class="number">0</span>;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="转意html"><a href="#转意html" class="headerlink" title="转意html"></a>转意html</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> escapeHTML = <span class="function">(<span class="params">html</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> htmlMap = &#123;</span><br><span class="line">    <span class="string">'&lt;'</span>: <span class="string">"&amp;lt;"</span>,</span><br><span class="line">    <span class="string">'&gt;'</span>:<span class="string">'&amp;gt;'</span>,</span><br><span class="line">    <span class="string">'&amp;'</span>:<span class="string">'&amp;amp'</span>,</span><br><span class="line">    <span class="string">'"'</span>:<span class="string">'&amp;quot;'</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> html.replace(<span class="regexp">/[&lt;&gt;"&amp;]/g</span>, (char) =&gt; htmlMap[char]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="操作cookie"><a href="#操作cookie" class="headerlink" title="操作cookie"></a>操作cookie</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  这里主要是一些操作cookie时候的一些工具方法</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Utils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//第一个方法主要用于转义cookie里面的特殊字符</span></span><br><span class="line">  encode(str)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">String</span>(str).replace(<span class="regexp">/[,;"\s%\\]/g</span>, (c) =&gt; <span class="built_in">encodeURIComponent</span>(c));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//第二个方法主要是用于对比编码的字符串进行解码的方法</span></span><br><span class="line">  decode(str)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(str);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//第三个方法主要是用于判断变量是不是纯粹的javascript对象的方法</span></span><br><span class="line">  isPlainObject(obj)&#123;</span><br><span class="line">    <span class="keyword">return</span> !!obj &amp;&amp; <span class="built_in">Object</span>.prototype.toString.call(obj) === <span class="string">'[object Object]'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//第四个方法主要是进行回退的方法</span></span><br><span class="line">  fallback(value, fallback)&#123;</span><br><span class="line">    <span class="keyword">return</span> value == <span class="literal">null</span> ? fallback : value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Utils();</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> util <span class="keyword">from</span> <span class="string">'./utils.js'</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  这个是操作cookie的主要的类</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cookie</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(config)&#123;</span><br><span class="line">    <span class="keyword">this</span>.defaultConfig = util.isPlainObject(config) ? config : &#123;<span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">domain</span>:<span class="string">''</span>, <span class="attr">secure</span>: <span class="literal">false</span>, <span class="attr">expires</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">this</span>.defaultTime = <span class="number">60</span> * <span class="number">60</span> *<span class="number">24</span> * <span class="number">1000</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  set(key, value, options)&#123;</span><br><span class="line">    <span class="comment">//设置cookie的方法--主要有两种设置形式，key为字符串或者对象也可以是数组。当key是字符串的时候，value就是其对应的值，当key是对象的时候，则键表示cookie的名称</span></span><br><span class="line">    <span class="comment">//值表示cookie的值，value参数则是options设置对象，此时所有的cookie共用一个相同的选项设置对象</span></span><br><span class="line">    <span class="comment">//当cookie是数组的时候，设置形式如下 [&#123;name:value, 'options':&#123;这个对象就是对应的配置选项&#125;&#125;,...]</span></span><br><span class="line">    <span class="comment">//name就是cookie的名称 value就是cookie的值  option就是这个cookie对应的选项对象</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//先判断是不是对象--是对象的话，就利用循环转换成不是对象的cookie的设置方式</span></span><br><span class="line">    <span class="keyword">if</span>(util.isPlainObject(key))&#123;</span><br><span class="line">      <span class="comment">//key是对象的情况--先判断一下key.option是否存在，存在则使用这个，不存在则使用options。注意这个时候的options是设置在value上的</span></span><br><span class="line">      value = key.option ? key.option : value;</span><br><span class="line">      <span class="built_in">Object</span>.keys(key).forEach(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">        v !== <span class="string">'option'</span> &amp;&amp; <span class="keyword">this</span>.set(v, key[v], value);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">Array</span>.isArray(key))&#123;</span><br><span class="line">      <span class="comment">//key是数组的情况</span></span><br><span class="line">      key.forEach(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.set(v, value);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="comment">//key是字符串的情况</span></span><br><span class="line">      <span class="comment">//先对options进行类型的判断</span></span><br><span class="line">      options = util.isPlainObject(options) ? options : &#123;<span class="attr">expires</span>:<span class="number">1</span>&#125;</span><br><span class="line">      <span class="comment">//然后再获取到cookie中最重要的一项设置--expires</span></span><br><span class="line">      <span class="keyword">let</span> expires = options.expires || <span class="keyword">this</span>.defaultConfig.expires || <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">let</span> path = options.path || <span class="keyword">this</span>.defaultConfig.path || <span class="string">'/'</span>;</span><br><span class="line">      <span class="keyword">let</span> secure = options.secure || <span class="keyword">this</span>.defaultConfig.secure || <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">let</span> domain = options.domain || <span class="keyword">this</span>.defaultConfig.domain || <span class="string">''</span>;</span><br><span class="line">      <span class="keyword">let</span> expiresType = <span class="keyword">typeof</span> expires;</span><br><span class="line">      <span class="keyword">if</span>(expiresType === <span class="string">'string'</span>)&#123;</span><br><span class="line">        expires = <span class="keyword">new</span> <span class="built_in">Date</span>(expires);</span><br><span class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(expiresType === <span class="string">'number'</span>)&#123;</span><br><span class="line">        expires = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.now() + <span class="keyword">this</span>.defaultTime * expires);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//然后在对expires进行标准化</span></span><br><span class="line">      (<span class="string">'toGMTString'</span> <span class="keyword">in</span> expires) &amp;&amp; (expires = expires.toGMTString());</span><br><span class="line">      <span class="comment">//设置cookie</span></span><br><span class="line">      <span class="built_in">document</span>.cookie = <span class="string">`<span class="subst">$&#123;util.encode(key)&#125;</span>=<span class="subst">$&#123;util.encode(value)&#125;</span>; path=<span class="subst">$&#123;path&#125;</span>; domain=<span class="subst">$&#123;domain&#125;</span>; expires=<span class="subst">$&#123;expires&#125;</span>; secure=<span class="subst">$&#123;secure&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  get(key)&#123;</span><br><span class="line">    <span class="comment">//获取cookie的方法--如果不传递参数，则默认是获取所有的cookie,以json对象的形式返回-也可以传递一个参数--获取指定名称的cookie</span></span><br><span class="line">    <span class="keyword">let</span> cookies = <span class="built_in">document</span>.cookie;</span><br><span class="line">    <span class="keyword">let</span> cookieResult = &#123;&#125;;</span><br><span class="line">    <span class="keyword">let</span> result = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//浏览器客户端没有cookie，则直接返回</span></span><br><span class="line">    <span class="keyword">if</span>(cookies == <span class="string">""</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    cookies.split(<span class="string">'; '</span>).forEach(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">      value.replace(<span class="regexp">/^(.+)=(.+)$/g</span>, (a, k, v) =&gt; &#123;</span><br><span class="line">        cookieResult[k] = v;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//利用参数判断返回的情况</span></span><br><span class="line">    <span class="comment">//这里主要分三种情况--1、key是字符串，返回对应的cookie值--2、key是数组，返回一个包含这些名称的json对象--3、key不存在，直接返回所有的cookie，json对象格式</span></span><br><span class="line">    <span class="keyword">if</span>(key &amp;&amp; <span class="built_in">Array</span>.isArray(key))&#123;</span><br><span class="line">      key.forEach(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">        result[v] = cookieResult[v];</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(key &amp;&amp; <span class="keyword">typeof</span> key === <span class="string">'string'</span>)&#123;</span><br><span class="line">      result = cookieResult[key];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      result = cookieResult;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  clear(key)&#123;</span><br><span class="line">    <span class="comment">//删除cookie的方法</span></span><br><span class="line">    <span class="comment">//分三种情况--1、key为undefined：删除所有的cookie</span></span><br><span class="line">    <span class="comment">//           2、key为数组：删除数组内指定的cookie</span></span><br><span class="line">    <span class="comment">//           3、key为字符串：删除指定名称的cookie</span></span><br><span class="line">    <span class="keyword">let</span> keyArr = <span class="built_in">Array</span>.isArray(key) ? key : (key !== <span class="literal">undefined</span> ? [key] : <span class="built_in">Object</span>.keys(<span class="keyword">this</span>.get()));</span><br><span class="line">    keyArr.forEach(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.set(v, <span class="string">''</span>, &#123;<span class="attr">expires</span>:<span class="number">-1</span>&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  isabled()&#123;</span><br><span class="line">    <span class="comment">//判断cookie是否能用的方法</span></span><br><span class="line">    <span class="keyword">return</span> navigator.cookieEnabled;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Cookie;</span><br></pre></td></tr></table></figure>
<h3 id="函数节流"><a href="#函数节流" class="headerlink" title="函数节流"></a>函数节流</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, wait, options</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//设置三个变量用于保存信息</span></span><br><span class="line">  <span class="keyword">var</span> context,  <span class="comment">//保存上下文</span></span><br><span class="line">      args, <span class="comment">//保存参数</span></span><br><span class="line">      result; <span class="comment">//保存函数的返回值</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//设置一个保存定时器的timer</span></span><br><span class="line">  <span class="keyword">var</span> timeout = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//设置上一次函数执行的时间戳</span></span><br><span class="line">  <span class="keyword">var</span> previous = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//设置options的默认值</span></span><br><span class="line">  <span class="keyword">if</span>(!options)&#123;</span><br><span class="line">    options = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//设置执行函数</span></span><br><span class="line">  <span class="keyword">var</span> later = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//如果options.leading为false则每次出发回调后将previous置为0</span></span><br><span class="line">    previous = options.leading === <span class="literal">false</span> ? <span class="number">0</span> : <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">    timeout = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    result = func.apply(context, args);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!timeout)&#123;</span><br><span class="line">      context = args = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//先保存这次函数的执行时间</span></span><br><span class="line">    <span class="keyword">var</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接着判断是否需要在刚刚开始的时候执行函数</span></span><br><span class="line">    <span class="keyword">if</span>(!previous &amp;&amp; options.leading === <span class="literal">false</span>)&#123;</span><br><span class="line">      <span class="comment">//进到这里面说明就不需要</span></span><br><span class="line">      previous = now;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接着在获取到时间的差值</span></span><br><span class="line">    <span class="keyword">var</span> remaining = wait - (now - previous);  <span class="comment">//主要比较的就是两次函数的执行时间和预先设定的时间的差值</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//保存这个函数的上下文和参数</span></span><br><span class="line">    context = <span class="keyword">this</span>;</span><br><span class="line">    args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//开始根据判断条件进行函数的调用</span></span><br><span class="line">    <span class="keyword">if</span>(remaining &lt; <span class="number">0</span> || remaining &gt; wait)&#123;</span><br><span class="line">      <span class="comment">//进入到这里就表示函数可以进行调用了</span></span><br><span class="line">      <span class="comment">//remaining &lt; 0 一开始就要执行</span></span><br><span class="line">      <span class="comment">//remaining &gt; wait 正常的执行条件</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(timeout)&#123;</span><br><span class="line">        <span class="comment">//如果存在定时器，说明还有没有执行的定时器，清除掉</span></span><br><span class="line">        clearTimeout(timeout);</span><br><span class="line">        timeout = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//重置这次函数的执行时间，下次执行的时候需要判断</span></span><br><span class="line">      previous = now;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//执行函数</span></span><br><span class="line">      result = func.apply(context, args);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//重置变量，防止内存泄漏</span></span><br><span class="line">      <span class="keyword">if</span>(!timeout)&#123;</span><br><span class="line">        context = args = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!timeout &amp;&amp; options.trailing !== <span class="literal">false</span>)&#123;</span><br><span class="line">      <span class="comment">//最后一次需要出发的情况</span></span><br><span class="line">      timeout = setTimeout(later,remaining);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回结果</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="函数去抖"><a href="#函数去抖" class="headerlink" title="函数去抖"></a>函数去抖</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait, immedicate</span>)</span>&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    参数的基本解释：</span></span><br><span class="line"><span class="comment">      func: function 需要进行去抖的函数</span></span><br><span class="line"><span class="comment">      wait： 去抖时间</span></span><br><span class="line"><span class="comment">      immedicate： 设置去抖函数的触发时机，设置为true则事件发生的时候立即触发。否则在事件结束wait时间之后触发</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//设置几个需要用到的局部变量</span></span><br><span class="line">  <span class="keyword">var</span> context, <span class="comment">//存储this</span></span><br><span class="line">      args, <span class="comment">//存储传递给去抖函数的参数</span></span><br><span class="line">      timestamp, <span class="comment">//存储每次函数触发的时间</span></span><br><span class="line">      timeout, <span class="comment">//存储对定时器的引用</span></span><br><span class="line">      result; <span class="comment">//存储原函数的返回值</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">//主要就是这个函数，这个函数就是定时器调用的函数，我们需要在这个函数里面做一件十分重要的事就是判断函数触发的时机</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> later = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//首先获取时间差</span></span><br><span class="line">        <span class="keyword">var</span> last = <span class="built_in">Date</span>.now() - timestamp;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//再看一下有没有达到函数调用的时间</span></span><br><span class="line">        <span class="keyword">if</span>(last &lt; wait &amp;&amp; last &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">          <span class="comment">//重置函数调用</span></span><br><span class="line">          timeout = setTimeout(later, wait - last);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="comment">//说明可以调用函数了，</span></span><br><span class="line">          <span class="comment">//吧timeout设置为null，以便下次判断</span></span><br><span class="line">          timeout = <span class="literal">null</span>;</span><br><span class="line">          <span class="comment">//但是需要先判断一下immedicate，因为如果这个为true，则我们不需要调用了</span></span><br><span class="line">          <span class="keyword">if</span>(!immedicate)&#123;</span><br><span class="line">            <span class="comment">//说明不是立即调用</span></span><br><span class="line">            result = func.apply(context, args);</span><br><span class="line">            <span class="keyword">if</span>(!timeout)&#123;</span><br><span class="line">              context = args = <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//闭包的形式，方便传递参数</span></span><br><span class="line">        context = <span class="keyword">this</span>;</span><br><span class="line">        args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//每次函数调用的时间</span></span><br><span class="line">        timestamp = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> callNow = immedicate &amp;&amp; !timeout; <span class="comment">//immedicate为true且函数不是第一次调用</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!timeout)&#123;</span><br><span class="line">          <span class="comment">//如果能进到这里，表示的是这个函数不是第一次触发了</span></span><br><span class="line">          <span class="comment">//如果是第一次触发，我们需要调用定时器了</span></span><br><span class="line">          timeout = setTimeout(later, wait);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(callNow)&#123;</span><br><span class="line">          <span class="comment">//如果是立即调用，就直接调用func函数</span></span><br><span class="line">          result = func.apply(context, args);</span><br><span class="line">          context = args = <span class="literal">null</span>; <span class="comment">//释放资源</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="求数组最大值"><a href="#求数组最大值" class="headerlink" title="求数组最大值"></a>求数组最大值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayMax = <span class="function"><span class="params">arr</span> =&gt;</span> <span class="built_in">Math</span>.max(...arr)</span><br></pre></td></tr></table></figure>
<h3 id="求数组的最小值"><a href="#求数组的最小值" class="headerlink" title="求数组的最小值"></a>求数组的最小值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayMin = <span class="function"><span class="params">arr</span> =&gt;</span> <span class="built_in">Math</span>.min(...arr)</span><br></pre></td></tr></table></figure>
<h3 id="chunk函数"><a href="#chunk函数" class="headerlink" title="chunk函数"></a>chunk函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> chunk = <span class="function">(<span class="params">arr, size</span>) =&gt;</span> <span class="built_in">Array</span>.from(&#123;<span class="attr">length</span>: <span class="built_in">Math</span>.ceil(arr.length / size)&#125;, (v, i) =&gt; arr.slice(i * size, i * size + size))</span><br></pre></td></tr></table></figure>
<h3 id="compact-去除数组中值为falsey的元素"><a href="#compact-去除数组中值为falsey的元素" class="headerlink" title="compact: 去除数组中值为falsey的元素"></a>compact: 去除数组中值为falsey的元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> compact = <span class="function">(<span class="params">arr</span>) =&gt;</span> arr.filter(<span class="built_in">Boolean</span>)</span><br></pre></td></tr></table></figure>
<h3 id="计算一个值在数组中出现的次数"><a href="#计算一个值在数组中出现的次数" class="headerlink" title="计算一个值在数组中出现的次数"></a>计算一个值在数组中出现的次数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> countOccurrences = <span class="function">(<span class="params">arr, value</span>) =&gt;</span> arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> v === value ? a + <span class="number">1</span> : a + <span class="number">0</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="deepFlatten-拉平数组"><a href="#deepFlatten-拉平数组" class="headerlink" title="deepFlatten: 拉平数组"></a>deepFlatten: 拉平数组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> deepFlatten = <span class="function">(<span class="params">arr</span>) =&gt;</span> [].concat(...arr.map(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">Array</span>.isArray(v) ? deepFlatten(v) : v))</span><br></pre></td></tr></table></figure>
<h3 id="difference-返回数组的差值"><a href="#difference-返回数组的差值" class="headerlink" title="difference: 返回数组的差值"></a>difference: 返回数组的差值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> difference = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>(b)</span><br><span class="line">  <span class="keyword">return</span> a.filter(<span class="function"><span class="params">x</span> =&gt;</span> !s.has(x))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="删除数组中的元素，直到回调函数返回true"><a href="#删除数组中的元素，直到回调函数返回true" class="headerlink" title="删除数组中的元素，直到回调函数返回true"></a>删除数组中的元素，直到回调函数返回true</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dropElements = <span class="function">(<span class="params">arr, func</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">while</span>(arr.length &gt; <span class="number">0</span> &amp;&amp; !func(arr[<span class="number">0</span>])) &#123;</span><br><span class="line">    arr.shift()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="返回索引是某个值的倍数的元素"><a href="#返回索引是某个值的倍数的元素" class="headerlink" title="返回索引是某个值的倍数的元素"></a>返回索引是某个值的倍数的元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> everyNth = <span class="function">(<span class="params">arr, nth</span>) =&gt;</span> arr.filter(<span class="function">(<span class="params">e, i</span>) =&gt;</span> i % nth === <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="过滤出数组中没有重复值的元素"><a href="#过滤出数组中没有重复值的元素" class="headerlink" title="过滤出数组中没有重复值的元素"></a>过滤出数组中没有重复值的元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filterNoneUnique = <span class="function"><span class="params">arr</span> =&gt;</span> arr.filter(<span class="function"><span class="params">i</span> =&gt;</span> arr.indexOf(i) === arr.lastIndexOf(i))</span><br></pre></td></tr></table></figure>
<h3 id="拉平数组"><a href="#拉平数组" class="headerlink" title="拉平数组"></a>拉平数组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flatten = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(v), [])</span><br></pre></td></tr></table></figure>
<h3 id="拉平数组-深拉平"><a href="#拉平数组-深拉平" class="headerlink" title="拉平数组(深拉平)"></a>拉平数组(深拉平)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flattenDepth = <span class="function">(<span class="params">arr, depth = <span class="number">1</span></span>) =&gt;</span> depth != <span class="number">1</span> ? arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(<span class="built_in">Array</span>.isArray(v) ? flattenDepth(v, depth - <span class="number">1</span>) : v), []) : arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(v), [])</span><br></pre></td></tr></table></figure>
<h3 id="对数组按照特定条件分组"><a href="#对数组按照特定条件分组" class="headerlink" title="对数组按照特定条件分组"></a>对数组按照特定条件分组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> groupBy = <span class="function">(<span class="params">arr, func</span>) =&gt;</span> arr.map(<span class="keyword">typeof</span> func === <span class="string">'function'</span> ? func : <span class="function"><span class="params">val</span> =&gt;</span> val[func])</span><br><span class="line">                                  .reduce(<span class="function">(<span class="params">acc, val, i</span>) =&gt;</span> &#123;</span><br><span class="line">                                    acc[val] = (acc[val] || []).concat(arr[i])</span><br><span class="line">                                    <span class="keyword">return</span> acc</span><br><span class="line">                                  &#125;, &#123;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="返回数组的第一个元素"><a href="#返回数组的第一个元素" class="headerlink" title="返回数组的第一个元素"></a>返回数组的第一个元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> head = <span class="function"><span class="params">arr</span> =&gt;</span> arr[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<h3 id="返回除数组最后一个元素之外的所有元素"><a href="#返回除数组最后一个元素之外的所有元素" class="headerlink" title="返回除数组最后一个元素之外的所有元素"></a>返回除数组最后一个元素之外的所有元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initial = <span class="function"><span class="params">arr</span> =&gt;</span> arr.slice(<span class="number">0</span>, <span class="number">-1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="初始化范围数组"><a href="#初始化范围数组" class="headerlink" title="初始化范围数组"></a>初始化范围数组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initializeArrayWithRange = <span class="function">(<span class="params">end, start = <span class="number">0</span></span>) =&gt;</span> <span class="built_in">Array</span>.from(&#123;<span class="attr">length</span>: end - start&#125;).map(<span class="function">(<span class="params">v, i</span>) =&gt;</span> i + start)</span><br></pre></td></tr></table></figure>
<h3 id="初始化并以特定的值填充数组"><a href="#初始化并以特定的值填充数组" class="headerlink" title="初始化并以特定的值填充数组"></a>初始化并以特定的值填充数组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initializeArrayWithValues = <span class="function">(<span class="params">n, value = <span class="number">0</span></span>) =&gt;</span> <span class="built_in">Array</span>(n).fill(value)</span><br></pre></td></tr></table></figure>
<h3 id="返回数组交集"><a href="#返回数组交集" class="headerlink" title="返回数组交集"></a>返回数组交集</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> intersection = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>(b)</span><br><span class="line">  <span class="keyword">return</span> a.filter(<span class="function"><span class="params">x</span> =&gt;</span> s.has(x))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="返回数组的最后一个元素"><a href="#返回数组的最后一个元素" class="headerlink" title="返回数组的最后一个元素"></a>返回数组的最后一个元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> last = <span class="function"><span class="params">arr</span> =&gt;</span> arr[arr.length - <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<h3 id="将数组中的值映射到对象"><a href="#将数组中的值映射到对象" class="headerlink" title="将数组中的值映射到对象"></a>将数组中的值映射到对象</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapObject = <span class="function">(<span class="params">arr, fn</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> keyValue = [arr, arr.map(fn)]</span><br><span class="line">  <span class="keyword">return</span> keyValue[<span class="number">0</span>].reduce(<span class="function">(<span class="params">acc, val, ind</span>) =&gt;</span> (acc[val] = keyValue[<span class="number">1</span>][ind], acc), &#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="返回数组的第n个元素"><a href="#返回数组的第n个元素" class="headerlink" title="返回数组的第n个元素"></a>返回数组的第n个元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> nthElement = <span class="function">(<span class="params">arr, n = <span class="number">0</span></span>) =&gt;</span> (n &gt; <span class="number">0</span> ? arr.slice(n + <span class="number">1</span>) : arr.slice(n))[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<h3 id="从对象中选取给定键的键值对"><a href="#从对象中选取给定键的键值对" class="headerlink" title="从对象中选取给定键的键值对"></a>从对象中选取给定键的键值对</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pick = <span class="function">(<span class="params">obj, arr</span>) =&gt;</span> arr.reduce(<span class="function">(<span class="params">acc, curr</span>) =&gt;</span> (curr <span class="keyword">in</span> obj &amp;&amp; (acc[curr] = obj[curr]), acc), &#123;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="从数组中筛选指定的值"><a href="#从数组中筛选指定的值" class="headerlink" title="从数组中筛选指定的值"></a>从数组中筛选指定的值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pull = <span class="function">(<span class="params">arr, ...args</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> pulled = arr.filter(<span class="function"><span class="params">v</span> =&gt;</span> !args.includes(v))</span><br><span class="line">  arr.length = <span class="number">0</span></span><br><span class="line">  pulled.forEach(<span class="function"><span class="params">v</span> =&gt;</span> arr.push(v))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="从数组中移除使给定函数返回false的元素"><a href="#从数组中移除使给定函数返回false的元素" class="headerlink" title="从数组中移除使给定函数返回false的元素"></a>从数组中移除使给定函数返回false的元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> remove = <span class="function">(<span class="params">arr, func</span>) =&gt;</span> <span class="built_in">Array</span>.isArray(arr) ? arr.filter(func).reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> &#123;</span><br><span class="line">  arr.splice(arr.indexOf(val), <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">return</span> acc.concat(val)</span><br><span class="line">&#125;, []) : []</span><br></pre></td></tr></table></figure>
<h3 id="返回数组中的随机的元素"><a href="#返回数组中的随机的元素" class="headerlink" title="返回数组中的随机的元素"></a>返回数组中的随机的元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sample = <span class="function"><span class="params">arr</span> =&gt;</span> arr[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * arr.length)]</span><br></pre></td></tr></table></figure>
<h3 id="打乱数组的顺序"><a href="#打乱数组的顺序" class="headerlink" title="打乱数组的顺序"></a>打乱数组的顺序</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shuffle = <span class="function"><span class="params">arr</span> =&gt;</span> arr.sort(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Math</span>.random() - <span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>
<h3 id="返回两个数组的交集"><a href="#返回两个数组的交集" class="headerlink" title="返回两个数组的交集"></a>返回两个数组的交集</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> similiarity = <span class="function">(<span class="params">arr, values</span>) =&gt;</span> arr.filter(<span class="function"><span class="params">v</span> =&gt;</span> values.includes(v))</span><br></pre></td></tr></table></figure>
<h3 id="返回两个数组的差值"><a href="#返回两个数组的差值" class="headerlink" title="返回两个数组的差值"></a>返回两个数组的差值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> symmetricDifference = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> sA = <span class="keyword">new</span> <span class="built_in">Set</span>(a)</span><br><span class="line">  <span class="keyword">const</span> sB = <span class="keyword">new</span> <span class="built_in">Set</span>(b)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    ...a.filter(<span class="function"><span class="params">x</span> =&gt;</span> !sB.has(x)),</span><br><span class="line">    ...b.filter(<span class="function"><span class="params">x</span> =&gt;</span> !sA.has(x))</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="返回数组中第一个之外的元素"><a href="#返回数组中第一个之外的元素" class="headerlink" title="返回数组中第一个之外的元素"></a>返回数组中第一个之外的元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tail = <span class="function"><span class="params">arr</span> =&gt;</span> arr.length &gt; <span class="number">1</span> ? arr.slice(<span class="number">1</span>) : arr</span><br></pre></td></tr></table></figure>
<h3 id="返回数组的前n个元素"><a href="#返回数组的前n个元素" class="headerlink" title="返回数组的前n个元素"></a>返回数组的前n个元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> take = <span class="function">(<span class="params">arr, n = <span class="number">1</span></span>) =&gt;</span> arr.slice(<span class="number">0</span>, n)</span><br></pre></td></tr></table></figure>
<h3 id="返回数组的并集"><a href="#返回数组的并集" class="headerlink" title="返回数组的并集"></a>返回数组的并集</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> union = <span class="function">(<span class="params">a, b</span>) =&gt;</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>([...a, ...b]))</span><br></pre></td></tr></table></figure>
<h3 id="筛选数组剔除某些值的元素"><a href="#筛选数组剔除某些值的元素" class="headerlink" title="筛选数组剔除某些值的元素"></a>筛选数组剔除某些值的元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> without = <span class="function">(<span class="params">arr, ...args</span>) =&gt;</span> arr.filter(<span class="function"><span class="params">v</span> =&gt;</span> !args.includes(v))</span><br></pre></td></tr></table></figure>
<h3 id="zip函数"><a href="#zip函数" class="headerlink" title="zip函数"></a>zip函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> zip = <span class="function">(<span class="params">...arrays</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> maxLength = <span class="built_in">Math</span>.max(...arrays.map(<span class="function"><span class="params">x</span> =&gt;</span> x.length))</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(&#123;<span class="attr">length</span>: maxLength&#125;).map(<span class="function">(<span class="params">_, i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(&#123;<span class="attr">length</span>: arrays.length&#125;, (_, k) =&gt; arrays[k][i])</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="判断元素是否在可视区内"><a href="#判断元素是否在可视区内" class="headerlink" title="判断元素是否在可视区内"></a>判断元素是否在可视区内</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> elementIsVisibleInViewport = <span class="function">(<span class="params">el, partiallyVisible = <span class="literal">false</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; top, left, bottom, right &#125; = el.getBoundingClientRect()</span><br><span class="line">  <span class="keyword">return</span> partiallyVisible</span><br><span class="line">  ? ((top &gt; <span class="number">0</span> &amp;&amp; top &lt; innerHeight) || (bottom &gt; <span class="number">0</span> &amp;&amp; bottom &lt; innerHeight) || (left &gt; <span class="number">0</span> &amp;&amp; left &lt; innerWidth) || (right &gt; <span class="number">0</span> &amp;&amp; right &lt; innerWidth))</span><br><span class="line">  : top &gt;= <span class="number">0</span> &amp;&amp; left &gt;= <span class="number">0</span> &amp;&amp; bottom &lt;= innerHeight &amp;&amp; right &lt;= innerWidth</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="获取当前页的滚动位置"><a href="#获取当前页的滚动位置" class="headerlink" title="获取当前页的滚动位置"></a>获取当前页的滚动位置</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getScrollPosition = <span class="function">(<span class="params">el = <span class="built_in">window</span></span>) =&gt;</span> (&#123;</span><br><span class="line">  x: el.pageXOffset ? el.pageXOffset : el.scrollLeft,</span><br><span class="line">  y: el.pageYOffset ? el.pageYOffset : el.scrollTop</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="获取url的查询字符串"><a href="#获取url的查询字符串" class="headerlink" title="获取url的查询字符串"></a>获取url的查询字符串</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getURLParameters = <span class="function"><span class="params">url</span> =&gt;</span> url.match(<span class="regexp">/([^?=&amp;]+)(=[^&amp;]*)/g</span>).reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> (a[v.slice(<span class="number">0</span>, v.indexOf(<span class="string">'='</span>))] = v.slice(v.indexOf(<span class="string">'='</span>) + <span class="number">1</span>), a), &#123;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="页面重定向"><a href="#页面重定向" class="headerlink" title="页面重定向"></a>页面重定向</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> redirect = <span class="function">(<span class="params">url, asLink = <span class="literal">true</span></span>) =&gt;</span> asLink ? <span class="built_in">window</span>.location.href = url : <span class="built_in">window</span>.location.replace(url)</span><br></pre></td></tr></table></figure>
<h3 id="平滑的滚动到页面的顶部"><a href="#平滑的滚动到页面的顶部" class="headerlink" title="平滑的滚动到页面的顶部"></a>平滑的滚动到页面的顶部</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> scrollTop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> c = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop</span><br><span class="line">  <span class="keyword">if</span>(c &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(scrollTop)</span><br><span class="line">    <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, c - c / <span class="number">8</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="返回两个日期之间的差异-天"><a href="#返回两个日期之间的差异-天" class="headerlink" title="返回两个日期之间的差异(天)"></a>返回两个日期之间的差异(天)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getDaysDiffBetweenDates = <span class="function">(<span class="params">dateInitial, dateFinal</span>) =&gt;</span> (dateInitial - dateFinal) / (<span class="number">1000</span> * <span class="number">3600</span> * <span class="number">24</span>)</span><br></pre></td></tr></table></figure>
<h3 id="将JSON对象转换为日期"><a href="#将JSON对象转换为日期" class="headerlink" title="将JSON对象转换为日期"></a>将JSON对象转换为日期</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> JSONToDate = <span class="function"><span class="params">arr</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> dt = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">parseInt</span>(arr.toString().substr(<span class="number">6</span>)))</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123; dt.getDate() &#125;</span>/<span class="subst">$&#123; dt.getMonth() + <span class="number">1</span> &#125;</span>/<span class="subst">$&#123; dt.getFullYear() &#125;</span>`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="链式异步函数"><a href="#链式异步函数" class="headerlink" title="链式异步函数"></a>链式异步函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> chainAsync = <span class="function"><span class="params">fns</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> curr = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> next = <span class="function"><span class="params">()</span> =&gt;</span> fns[curr++](next)</span><br><span class="line">  next()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="compose函数-从右向左执行函数"><a href="#compose函数-从右向左执行函数" class="headerlink" title="compose函数(从右向左执行函数)"></a>compose函数(从右向左执行函数)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> compose = <span class="function">(<span class="params">...fns</span>) =&gt;</span> fns.reduce(<span class="function">(<span class="params">f, g</span>) =&gt;</span> (...args) =&gt; f(g(...args)))</span><br></pre></td></tr></table></figure>
<h3 id="pipe函数-从左向右执行函数"><a href="#pipe函数-从左向右执行函数" class="headerlink" title="pipe函数(从左向右执行函数)"></a>pipe函数(从左向右执行函数)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pipe = <span class="function">(<span class="params">...fns</span>) =&gt;</span> fns.reduce(<span class="function">(<span class="params">f, g</span>) =&gt;</span> (...args) =&gt; g(f(...args)))</span><br></pre></td></tr></table></figure>
<h3 id="将异步函数转换为一个promise"><a href="#将异步函数转换为一个promise" class="headerlink" title="将异步函数转换为一个promise"></a>将异步函数转换为一个promise</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promisify = <span class="function"><span class="params">func</span> =&gt;</span> (...args) =&gt; <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> func(...args, (err, result) =&gt; err ? reject(err) : resolve(result)))</span><br></pre></td></tr></table></figure>
<h3 id="顺序执行一系列的promise"><a href="#顺序执行一系列的promise" class="headerlink" title="顺序执行一系列的promise"></a>顺序执行一系列的promise</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> runPromiseSeries = <span class="function"><span class="params">ps</span> =&gt;</span> ps.reduce(<span class="function">(<span class="params">p, next</span>) =&gt;</span> p.then(next), <span class="built_in">Promise</span>.resolve())</span><br></pre></td></tr></table></figure>
<h3 id="延迟异步函数的执行"><a href="#延迟异步函数的执行" class="headerlink" title="延迟异步函数的执行"></a>延迟异步函数的执行</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sleep = <span class="function"><span class="params">ms</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> setTimeout(resolve, ms))</span><br></pre></td></tr></table></figure>
<h3 id="返回一组数据的平均值"><a href="#返回一组数据的平均值" class="headerlink" title="返回一组数据的平均值"></a>返回一组数据的平均值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayAverage = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>) / arr.length</span><br></pre></td></tr></table></figure>
<h3 id="返回一组数据的总和"><a href="#返回一组数据的总和" class="headerlink" title="返回一组数据的总和"></a>返回一组数据的总和</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arraySum = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Collatz算法-如果n是偶数-则返回n-2。否则返回3n-1"><a href="#Collatz算法-如果n是偶数-则返回n-2。否则返回3n-1" class="headerlink" title="Collatz算法(如果n是偶数, 则返回n/2。否则返回3n+1)"></a>Collatz算法(如果n是偶数, 则返回n/2。否则返回3n+1)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> collatz = <span class="function"><span class="params">n</span> =&gt;</span> n % <span class="number">2</span> === <span class="number">0</span> ? n / <span class="number">2</span> : <span class="number">3</span> * n + <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="将数字转换为数组"><a href="#将数字转换为数组" class="headerlink" title="将数字转换为数组"></a>将数字转换为数组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> digitize = <span class="function"><span class="params">n</span> =&gt;</span> [...String(n)].map(<span class="function"><span class="params">i</span> =&gt;</span> <span class="built_in">parseInt</span>(i))</span><br></pre></td></tr></table></figure>
<h3 id="计算两点之间的距离"><a href="#计算两点之间的距离" class="headerlink" title="计算两点之间的距离"></a>计算两点之间的距离</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> distance = <span class="function">(<span class="params">x0, y0, x1, y1</span>) =&gt;</span> <span class="built_in">Math</span>.hypot(x1 - x0, y1 - y0)</span><br></pre></td></tr></table></figure>
<h3 id="计算一个数字的阶乘"><a href="#计算一个数字的阶乘" class="headerlink" title="计算一个数字的阶乘"></a>计算一个数字的阶乘</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> factorial = <span class="function"><span class="params">n</span> =&gt;</span> n &lt; <span class="number">0</span> ? <span class="function">(<span class="params">(</span>) =&gt;</span> &#123;<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Negative numbers are not allowed!'</span>)&#125;)() : n &lt;= <span class="number">1</span> ? n : n * factorial(n - <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="包含斐波那契值的数组"><a href="#包含斐波那契值的数组" class="headerlink" title="包含斐波那契值的数组"></a>包含斐波那契值的数组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fibonacci = <span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">Array</span>(n).fill(<span class="number">0</span>).reduce(<span class="function">(<span class="params">acc, val, i</span>) =&gt;</span> acc.concat(i &gt; <span class="number">1</span> ? acc[i - <span class="number">1</span>] + acc[i - <span class="number">2</span>] : i), [])</span><br></pre></td></tr></table></figure>
<h3 id="计算两个数字的最大公约数-important"><a href="#计算两个数字的最大公约数-important" class="headerlink" title="计算两个数字的最大公约数(important)"></a>计算两个数字的最大公约数(important)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gcd = <span class="function">(<span class="params">x, y</span>) =&gt;</span> !y ? x : gcd(y, x % y)</span><br></pre></td></tr></table></figure>
<h3 id="计算两个数字的最小公倍数-important"><a href="#计算两个数字的最小公倍数-important" class="headerlink" title="计算两个数字的最小公倍数(important)"></a>计算两个数字的最小公倍数(important)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> lcm = <span class="function">(<span class="params">x,y</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> gcd = <span class="function">(<span class="params">x, y</span>) =&gt;</span> !y ? x : gcd(y, x % y);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.abs(x*y)/(gcd(x,y));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="返回数字数组的中间值"><a href="#返回数字数组的中间值" class="headerlink" title="返回数字数组的中间值"></a>返回数字数组的中间值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> median = <span class="function"><span class="params">arr</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mid = <span class="built_in">Math</span>.floor(arr.length / <span class="number">2</span>)</span><br><span class="line">  <span class="keyword">const</span> nums = arr.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> arr.length % <span class="number">2</span> !== <span class="number">0</span> ? nums[mid] ? (nums[mid - <span class="number">1</span>] + nums[mid]) / <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="返回指定范围内的随机整数"><a href="#返回指定范围内的随机整数" class="headerlink" title="返回指定范围内的随机整数"></a>返回指定范围内的随机整数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> randomIntegerInRange = <span class="function">(<span class="params">min, max</span>) =&gt;</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (max - min + <span class="number">1</span>)) + min</span><br></pre></td></tr></table></figure>
<h3 id="返回指定范围内的随机数"><a href="#返回指定范围内的随机数" class="headerlink" title="返回指定范围内的随机数"></a>返回指定范围内的随机数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> randomNumberInRange = <span class="function">(<span class="params">min, max</span>) =&gt;</span> <span class="built_in">Math</span>.random() * (max - min) + min</span><br></pre></td></tr></table></figure>
<h3 id="将数字保留指定的位数"><a href="#将数字保留指定的位数" class="headerlink" title="将数字保留指定的位数"></a>将数字保留指定的位数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> round = <span class="function">(<span class="params">n, decimals = <span class="number">0</span></span>) =&gt;</span> <span class="built_in">Number</span>(<span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.round(<span class="string">`<span class="subst">$&#123;n&#125;</span>e<span class="subst">$&#123;decimals&#125;</span>`</span>)&#125;</span>e-<span class="subst">$&#123;decimals&#125;</span>`</span>)</span><br></pre></td></tr></table></figure>
<h3 id="返回数字数组的标准差"><a href="#返回数字数组的标准差" class="headerlink" title="返回数字数组的标准差"></a>返回数字数组的标准差</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> standardDeviation = <span class="function">(<span class="params">arr, usePopulation = <span class="literal">false</span></span>) =&gt;</span> &#123;</span><br><span class="line">  onst mean = arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>) / arr.length;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(</span><br><span class="line">    arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc.concat(<span class="built_in">Math</span>.pow(val - mean, <span class="number">2</span>)), [])</span><br><span class="line">    .reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>) / (arr.length - (usePopulation ? <span class="number">0</span> : <span class="number">1</span>))</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="从json对象中移除指定属性之外的任何特性"><a href="#从json对象中移除指定属性之外的任何特性" class="headerlink" title="从json对象中移除指定属性之外的任何特性"></a>从json对象中移除指定属性之外的任何特性</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cleanObj = <span class="function">(<span class="params">obj, keysToKeep = [], childIndicator</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">Object</span>.keys(obj).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(key === childIndicator) &#123;</span><br><span class="line">      cleanObj(obj[key], keysToKeep, childIndicator)</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!keysToKeep.includes(key)) &#123;</span><br><span class="line">      <span class="keyword">delete</span> obj[key]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="从给定的键值对创建对象"><a href="#从给定的键值对创建对象" class="headerlink" title="从给定的键值对创建对象"></a>从给定的键值对创建对象</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> objectFromPairs = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> (a[v[<span class="number">0</span>]] = v[<span class="number">1</span>], a), &#123;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="将json对象转化为键值对数组"><a href="#将json对象转化为键值对数组" class="headerlink" title="将json对象转化为键值对数组"></a>将json对象转化为键值对数组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> objectToPairs = <span class="function"><span class="params">obj</span> =&gt;</span> <span class="built_in">Object</span>.keys(obj).map(<span class="function"><span class="params">k</span> =&gt;</span> [k, obj[k]])</span><br></pre></td></tr></table></figure>
<h3 id="浅复制"><a href="#浅复制" class="headerlink" title="浅复制"></a>浅复制</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shallowClone = <span class="function"><span class="params">obj</span> =&gt;</span> <span class="built_in">Object</span>.assign(&#123;&#125;, obj)</span><br></pre></td></tr></table></figure>
<h3 id="将字符串中每个单词的首字母大写"><a href="#将字符串中每个单词的首字母大写" class="headerlink" title="将字符串中每个单词的首字母大写"></a>将字符串中每个单词的首字母大写</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> capitalizeEveryWord = <span class="function"><span class="params">str</span> =&gt;</span> str.replace(<span class="regexp">/\b[a-z]/g</span>, char =&gt; char.toUpperCase())</span><br></pre></td></tr></table></figure>
<h3 id="转义正则表达式中用到的字符"><a href="#转义正则表达式中用到的字符" class="headerlink" title="转义正则表达式中用到的字符"></a>转义正则表达式中用到的字符</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> escapeRegExp = <span class="function"><span class="params">str</span> =&gt;</span> str.replace(<span class="regexp">/[.*+?^$&#123;&#125;()|[\]\\]/g</span>, <span class="string">'\\$&amp;'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="将驼峰法字符串转换为指定形式"><a href="#将驼峰法字符串转换为指定形式" class="headerlink" title="将驼峰法字符串转换为指定形式"></a>将驼峰法字符串转换为指定形式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fromCamelCase = <span class="function">(<span class="params">str, separator = <span class="string">'_'</span></span>) =&gt;</span> str.replace(<span class="regexp">/([a-z\d])([A-Z])/g</span>, <span class="string">'$1'</span> + separator + <span class="string">'$2'</span>)</span><br><span class="line">.replace(<span class="regexp">/([A-Z]+)([A-Z][a-z\d]+)/g</span>, <span class="string">'$1'</span> + separator + <span class="string">'$2'</span>).toLowerCase();</span><br></pre></td></tr></table></figure>
<h3 id="为字符串加…"><a href="#为字符串加…" class="headerlink" title="为字符串加…"></a>为字符串加…</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> truncateString = <span class="function">(<span class="params">str, num</span>) =&gt;</span></span><br><span class="line">str.length &gt; num ? str.slice(<span class="number">0</span>, num &gt; <span class="number">3</span> ? num - <span class="number">3</span> : num) + <span class="string">'...'</span> : str;</span><br></pre></td></tr></table></figure>
<h3 id="hexToRgb"><a href="#hexToRgb" class="headerlink" title="hexToRgb"></a>hexToRgb</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> hexToRgb = <span class="function"><span class="params">hex</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> extendHex = <span class="function"><span class="params">shortHex</span> =&gt;</span> <span class="string">'#'</span> + shortHex.slice(shortHex.startWith(<span class="string">'#'</span>) ? <span class="number">1</span> : <span class="number">0</span>).split(<span class="string">''</span>).map(<span class="function"><span class="params">x</span> =&gt;</span> x + x).join(<span class="string">''</span>)</span><br><span class="line">  <span class="keyword">const</span> extendedHex = hex.slice(hex.startsWith(<span class="string">'#'</span>) ? <span class="number">1</span> : <span class="number">0</span>).length === <span class="number">3</span> ? extendHex(hex) : hex</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`rgb(<span class="subst">$&#123;<span class="built_in">parseInt</span>(extendedHex.slice(<span class="number">1</span>), <span class="number">16</span>) &gt;&gt; <span class="number">16</span>&#125;</span>, <span class="subst">$&#123;(<span class="built_in">parseInt</span>(extendedHex.slice(<span class="number">1</span>), <span class="number">16</span>) &amp; <span class="number">0x00ff00</span>) &gt;&gt; <span class="number">8</span>&#125;</span>, <span class="subst">$&#123;<span class="built_in">parseInt</span>(extendedHex.slice(<span class="number">1</span>), <span class="number">16</span>) &amp; <span class="number">0x0000ff</span>&#125;</span>)`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RGBToHex"><a href="#RGBToHex" class="headerlink" title="RGBToHex"></a>RGBToHex</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> RGBToHex = <span class="function">(<span class="params">r, g, b</span>) =&gt;</span> ((r &lt;&lt; <span class="number">16</span>) + (g &lt;&lt; <span class="number">8</span>) + b).toString(<span class="number">16</span>).padStart(<span class="number">6</span>, <span class="string">'0'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="生成UUID"><a href="#生成UUID" class="headerlink" title="生成UUID"></a>生成UUID</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> UUIDGenerator = <span class="function"><span class="params">()</span> =&gt;</span></span><br><span class="line">  ([<span class="number">1e7</span>] + <span class="number">-1e3</span> + <span class="number">-4e3</span> + <span class="number">-8e3</span> + <span class="number">-1e11</span>).replace(<span class="regexp">/[018]/g</span>, c =&gt;</span><br><span class="line">  (c ^ crypto.getRandomValues(<span class="keyword">new</span> <span class="built_in">Uint8Array</span>(<span class="number">1</span>))[<span class="number">0</span>] &amp; <span class="number">15</span> &gt;&gt; c / <span class="number">4</span>).toString(<span class="number">16</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="验证邮箱"><a href="#验证邮箱" class="headerlink" title="验证邮箱"></a>验证邮箱</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validateEmail = <span class="function"><span class="params">str</span> =&gt;</span></span><br><span class="line">  /^(([^<span class="xml"><span class="tag">&lt;&gt;</span>()\[\]\\.,;:\s@"]+(\.[^<span class="tag">&lt;&gt;</span>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]&#123;2,&#125;))$/.test(str)</span></span><br></pre></td></tr></table></figure></div><!--文章标签--><div class="tags"><a href="/tags/代码库/">代码库</a></div><!--评论--></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><div class="widget-title"> 分类</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript-基础/">JavaScript 基础</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/gitbook/">gitbook</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/书单/">书单</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/代码库/">代码库</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/转载/">转载</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/遇到的问题/">遇到的问题</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/面试/">面试</a><span class="category-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"> 标签</div><div class="tagcloud"><a href="/tags/爬虫/" style="font-size: 14px;">爬虫</a> <a href="/tags/Hexo/" style="font-size: 12px;">Hexo</a> <a href="/tags/JavaScript/" style="font-size: 18px;">JavaScript</a> <a href="/tags/正则表达式/" style="font-size: 12px;">正则表达式</a> <a href="/tags/linux/" style="font-size: 12px;">linux</a> <a href="/tags/书单/" style="font-size: 12px;">书单</a> <a href="/tags/代码库/" style="font-size: 18px;">代码库</a> <a href="/tags/gitbook/" style="font-size: 12px;">gitbook</a> <a href="/tags/遇到的问题/" style="font-size: 12px;">遇到的问题</a> <a href="/tags/面试/" style="font-size: 16px;">面试</a> <a href="/tags/Git/" style="font-size: 12px;">Git</a> <a href="/tags/ES6/" style="font-size: 12px;">ES6</a> <a href="/tags/架构/" style="font-size: 12px;">架构</a> <a href="/tags/网络基础/" style="font-size: 12px;">网络基础</a></div></div></div></div></div><div id="footer">© <a href="/." rel="nofollow">Awoke.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> Theme<a target="_blank" href="https://github.com/7ye/maupassant-hexo"> Maupassant.</a></div><a id="back_to_top" href="javascript:void(0)" class="back_to_top"><span>△</span></a><script type="text/javascript" src="/js/totop.js?v=0.0.1"></script><link rel="stylesheet" href="/css/jquery.fancybox.css"><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1"></script><script>function auto_code_fit(){
  if($(".highlight").length != 0){
    var pc_width = $(".post-content").width();
    $(".highlight .code").find("pre").width((pc_width-70)+"px");
  }
}
window.onresize = function(){
  auto_code_fit();
}
auto_code_fit();</script></div></body>